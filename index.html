<!DOCTYPE html>
<html>
  <head>
    <title>Chemicle</title>
    <h1>Chemicle</h1>
    <h2>Computer Science Project by Wesley Ding</h2>
  </head>
  
  <script type="text/JavaScript">
    /*
    class Molecule {
      constructor(name) {
        this.name = name;
        this.splitName = this.generateSplit(name);
        this.formula = this.generateFormula();
      }

      generateSplit() {
        return "";
      }

      generateFormula() {
        return "";
      }

      static checkValid() {

      }
    }

    // Alkanes - Only Cs single bonded to Hs, maybe halogenated
    class FullAlkane extends SimpleAlkane {
      constructor(name) {
        super(name)
      }


    }

    // Simple Alkane - No branches, only Cs single bonded to Hs
    class SimpleAlkane extends Molecule {

    }

    // Alkyl Branch -
    class Alkyl extends Molecule {

    }
    */

    // parseMolecule(inputText): Accepts a string of text as input, returns an array of strings of the "decomposed" molecule. ("propane" -> ["prop", "ane"])
    function parseMolecule(inputText) {
      const splitAlkane = inputText.split(/(ane)$/); // Alkane - REGEX generated by ChatGPT
      return splitAlkane;
    }

    function handleSubmit() {
      const inputText = document.getElementById("guessInput").value;

      if (isValidOrganicChemical(inputText)) {
        document.getElementById("validWarning").hidden = true;
        showGuess();
        return false;
      } else {
        document.getElementById("validWarning").hidden = false;
        return false;
      }
    }

    curGuess = 1;
    function showGuess(){
      let inputText = document.getElementById("guessInput").value;
      console.log("Showing " + inputText);
      document.getElementById("guess" + curGuess).innerHTML = parseMolecule(inputText);
      document.getElementById("guessInput").value = "";
      if(curGuess < 6) {
        curGuess++;
      }
    }

    function isValidOrganicChemical(name)  {
      // Validity Checker and regex generated by ChatGPT, with prompts, fixes and modifications made by self
      // List of valid roots for hydrocarbons
      const roots = "(meth|eth|prop|but|pent|hex|hept|oct|non|dec|undec|dodec)";

      // Valid saturation suffixes
      const saturationSuffixes = "(ane|ene|yne|anol|anal|anone|anoic\\sacid|oate|anoate|\\sether)";

      // Functional group suffixes
      const functionalGroupSuffixes = "(yl)";

      // Cyclo or iso prefixes
      const prefix = "(cyclo|iso)?";

      // Branching patterns: di, tri, tetra, penta for multiple branches
      const branchPrefixes = "(di|tri|tetra|penta)?";

      // Alkyl chains (with optional number prefixes for positions)
      const alkylBranch = "(\\d{1,2}(,\\d{1,2})*-)?";

      // Handling branch names (like methyl, ethyl, etc.)
      const branch = `(${alkylBranch}${branchPrefixes}${roots}yl)`;

      // Combining all parts to handle alkyl branches (e.g., "2,3-dimethyl")
      const branchPart = `(${branch}(\\-${branch})*)?`;

      // Main hydrocarbon name (prefix + root + saturation + functional group)
      const mainName = `${prefix}${roots}${saturationSuffixes}(${functionalGroupSuffixes})?`;

      // Complete regex pattern for the whole name (optional branches + main name)
      const fullPattern = new RegExp(`^${branchPart}${mainName}$`, 'i');

      // Test if the input name matches the pattern
      return fullPattern.test(name.trim());
    }

  </script>
  
  <body>
    <p id="guess1"></p>
    <p id="guess2"></p>
    <p id="guess3"></p>
    <p id="guess4"></p>
    <p id="guess5"></p>
    <p id="guess6"></p>
    <form onsubmit="return handleSubmit();">
      <label for="guessInput"></label>
      <input type="text"
             id="guessInput"
             name="guessInput"
             required minlength="4"
             maxlength="24"
             size="10" />
      <input type="submit"
             name="submitButton"
             value="Submit" />
    </form>
    <p id="validWarning" hidden="hidden" style="color:red;">The input is invalid. Please check spelling and make sure your guess is a real molecule</p>
  </body>
</html>

